FROM python:3.11-slim
WORKDIR /app

# Copy project files
COPY backend/pyproject.toml backend/poetry.lock* /app/

# Install poetry and deps (without installing the project itself)
RUN pip install --no-cache-dir poetry \
    && poetry config virtualenvs.in-project false \
    && poetry install --no-interaction --no-ansi --no-root

COPY backend /app

ENV FLASK_APP=app.py
EXPOSE 8000
CMD ["poetry", "run", "python", "app.py"]
